<html>
<head>
<title>Python 3.11: What's New </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Python 3.11:新特性</h1>
<blockquote>原文：<a href="https://testdriven.io/blog/python311/#0001-01-01">https://testdriven.io/blog/python311/#0001-01-01</a></blockquote><div><div class="blog-content long-content" data-local-nav-source="">
    <p>Python 3.11发布于<a href="https://www.python.org/downloads/release/python-3110/">2021年</a>10月24日。本文着眼于Python语言中最有趣的新增内容，这些内容将有助于使您的Python代码更加整洁:</p>
<ol>
<li>更快的CPython</li>
<li>改进的类型提示</li>
<li>更好的错误消息</li>
<li>异常注释</li>
<li>TOML库</li>
</ol>



<h2 id="installing-python-311">安装Python 3.11</h2>
<p>如果您有Docker，您可以快速构建一个Python 3.11 shell来使用本文中的示例，如下所示:</p>
<div class="codehilite"><pre><span/><code>$ docker run -it --rm python:3.11
</code></pre></div>

<p>不用Docker？我们建议用<a href="https://github.com/pyenv/pyenv"> pyenv </a>安装Python 3.11:</p>


<p>从<a href="https://testdriven.io/blog/python-environments/#installing-python">Modern Python Environments-dependency and workspace management</a>文章中，您可以了解更多关于使用pyenv管理Python的信息。</p>
<h2 id="faster-cpython">更快的CPython</h2>
<p>Python 3.11比以往任何时候都快！正如<a href="https://docs.python.org/3.11/whatsnew/3.11.html">发布说明</a>中所说，Python 3.11比Python 3.10快10 - 60%。平均来说，要快25%。Python的核心开发人员在许多方面都做了很好的工作，改善了执行时间。</p>
<h3 id="faster-startup">更快启动</h3>
<p>启动方面，不是<em>读取<code>__pycache__</code> - &gt;解组- &gt;堆分配的代码对象- &gt;求值</em>，Python 3.11使用了新的进程。Python解释器启动所必需的核心模块现在被冻结在解释器中——它们的代码是静态分配的。新的流程是<em>静态分配代码对象- &gt;评估</em>。后者快10 - 15%。</p>
<h3 id="faster-runtime">更快的运行时间</h3>
<p>每次在Python中调用函数时，都会创建一个框架。它保存关于函数执行的信息。核心开发人员简化了他们的创建过程、内部信息和内存分配。另一个改进发生在内联函数调用上。从现在开始，大多数Python函数调用都不消耗C堆栈空间。</p>
<p>也许在这方面最重要的改进是<a href="https://peps.python.org/pep-0659/"> PEP 659:专门化自适应解释器</a>。这个PEP是fast Python的关键元素之一。它的主要思想是Python代码有类型很少改变的区域。在这些区域中，当Python发现某些操作总是只针对特定类型的数据时，它可以通过使用更专门化的类型来优化操作。例如，如果只使用整数，它可以对整数使用乘法，而不是使用一般的乘法。另一个例子是直接调用底层C实现的常见内置函数，如<code>len</code>和<code>str</code>，而不是通过内部调用约定。</p>
<p>您可以通过检查生成的字节码来观察这一点:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">dis</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>


<span class="k">def</span> <span class="nf">dollars_to_pounds</span><span class="p">(</span><span class="n">dollars</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.87</span> <span class="o">*</span> <span class="n">dollars</span>


<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">dollars_to_pounds</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#   5           0 RESUME                   0</span>
<span class="c1">#</span>
<span class="c1">#   6           2 LOAD_CONST               1 (0.87)</span>
<span class="c1">#               4 LOAD_FAST                0 (dollars)</span>
<span class="c1">#               6 BINARY_OP                5 (*)</span>
<span class="c1">#              10 RETURN_VALUE</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">dollars_to_pounds</span><span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>


<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">dollars_to_pounds</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#   5           0 RESUME_QUICK             0</span>
<span class="c1">#</span>
<span class="c1">#   6           2 LOAD_CONST__LOAD_FAST     1 (0.87)</span>
<span class="c1">#               4 LOAD_FAST                0 (dollars)</span>
<span class="c1">#               6 BINARY_OP_MULTIPLY_FLOAT     5 (*)  # &lt;--  CHANGED!</span>
<span class="c1">#              10 RETURN_VALUE</span>
</code></pre></div>

<p>正如您所看到的，在使用float调用了8次<code>dollars_to_pounds</code>之后，bytcode得到了优化。它没有使用<code>BINARY_OP</code>，而是使用了专门的<code>BINARY_OP_MULTIPLY_FLOAT</code>，在乘以浮点数时速度更快。如果你用一个旧的Python版本运行同样的东西，不会有任何不同。</p>
<p>更多信息，请参考<a href="https://docs.python.org/3/whatsnew/3.11.html#whatsnew311-faster-cpython">官方文档</a>以及相关的<a href="https://peps.python.org/pep-0659/"> PEP 659 -专业自适应解释器</a>。</p>
<h2 id="improved-type-hints">改进的类型提示</h2>
<p>与前几个版本一样，在类型提示方面有所改进。</p>
<h3 id="self-type">自身类型</h3>
<p>Python终于支持了一个<code>Self</code>类型。因此，现在您可以轻松地键入类方法和dunder方法:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Self</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">:</span>
    <span class="n">manufacture</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">car_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">manufacture</span><span class="o">=</span><span class="n">car_data</span><span class="p">[</span><span class="s2">"manufacture"</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">car_data</span><span class="p">[</span><span class="s2">"model"</span><span class="p">])</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Car</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">"manufacture"</span><span class="p">:</span> <span class="s2">"Alfa Romeo"</span><span class="p">,</span> <span class="s2">"model"</span><span class="p">:</span> <span class="s2">"Stelvio"</span><span class="p">}))</span>
<span class="c1"># Car(manufacture='Alfa Romeo', model='Stelvio')</span>
</code></pre></div>

<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3.11/whatsnew/3.11.html#whatsnew311-pep673">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0673/"> PEP-673 </a></li>
</ol>
<h3 id="typeddict-notrequired">TypedDict不需要</h3>
<p>另一个改进是用于类型化词典的<code>NotRequired</code>类型:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">NotRequired</span>


<span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">manufacture</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="n">car1</span><span class="p">:</span> <span class="n">Car</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"manufacture"</span><span class="p">:</span> <span class="s2">"Alfa Romeo"</span><span class="p">,</span> <span class="s2">"model"</span><span class="p">:</span> <span class="s2">"Stelvio"</span><span class="p">}</span>  <span class="c1"># OK</span>
<span class="n">car2</span><span class="p">:</span> <span class="n">Car</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"manufacture"</span><span class="p">:</span> <span class="s2">"Alfa Romeo"</span><span class="p">}</span>  <span class="c1"># model (model is not required)</span>
<span class="n">car3</span><span class="p">:</span> <span class="n">Car</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"model"</span><span class="p">:</span> <span class="s2">"Stelvio"</span><span class="p">}</span>  <span class="c1"># ERROR (missing required field manufacture)</span>
</code></pre></div>

<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3.11/whatsnew/3.11.html#whatsnew311-pep655">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0655/"> PEP-655 </a></li>
</ol>
<h3 id="literal-string-type">文字字符串类型</h3>
<p>还有一个新的<code>LiteralString</code>类型，允许文字字符串和从其他文字字符串创建的字符串。这可用于在执行SQL和shell命令时进行类型检查，以增加防止注入攻击的另一层安全性。</p>
<p><a href="https://docs.python.org/3/whatsnew/3.11.html#pep-675-arbitrary-literal-string-type">举例</a>:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">run_query</span><span class="p">(</span><span class="n">sql</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">...</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">caller</span><span class="p">(</span>
    <span class="n">arbitrary_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">query_string</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="n">LiteralString</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">run_query</span><span class="p">(</span><span class="s2">"SELECT * FROM students"</span><span class="p">)</span>       <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>                   <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="s2">"SELECT * FROM "</span> <span class="o">+</span> <span class="n">table_name</span><span class="p">)</span>  <span class="c1"># ok</span>
    <span class="n">run_query</span><span class="p">(</span><span class="n">arbitrary_string</span><span class="p">)</span>               <span class="c1"># type checker error</span>
    <span class="n">run_query</span><span class="p">(</span>                                <span class="c1"># type checker error</span>
        <span class="sa">f</span><span class="s2">"SELECT * FROM students WHERE name = </span><span class="si">{</span><span class="n">arbitrary_string</span><span class="si">}</span><span class="s2">"</span>
    <span class="p">)</span>
</code></pre></div>

<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3/whatsnew/3.11.html#whatsnew311-pep675">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0675/"> PEP-675 </a></li>
</ol>
<p>--</p>
<p>还有一些与类型提示相关的其他改进。你可以在<a href="https://docs.python.org/3/whatsnew/3.11.html#new-features-related-to-type-hints">官方发行说明</a>中读到它们。</p>
<h2 id="better-error-messages">更好的错误消息</h2>
<p>令人兴奋的新特性之一是更具描述性的回溯。Python 3.10引入了更好、更具描述性的错误，带来了一些改进。Python 3.11更进了一步，改进了对确切错误位置的描述。让我们看一个例子。</p>
<p>有语法错误的代码:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">average_grade</span><span class="p">(</span><span class="n">grades</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>


<span class="n">average_grade</span><span class="p">([])</span>
</code></pre></div>

<p>Python 3.10中的错误:</p>
<div class="codehilite"><pre><span/><code>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</code></pre></div>

<p>Python 3.11中的错误:</p>
<div class="codehilite"><pre><span/><code>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
           <span class="o">~~~~~~~~~~~~^~~~~~~~~~~~~</span>
<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</code></pre></div>

<p>来点更复杂的怎么样？</p>
<p>Python 3.10:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">send_email_to_contact</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Sending email to </span><span class="si">{</span><span class="n">contact</span><span class="p">[</span><span class="s1">'emails'</span><span class="p">][</span><span class="s1">'address'</span><span class="p">]</span><span class="si">}</span><span class="s2"> with subject=</span><span class="si">{</span><span class="n">subject</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">content</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>


<span class="n">contact</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"Lightning"</span><span class="p">,</span>
    <span class="s2">"last_name"</span><span class="p">:</span> <span class="s2">"McQueen"</span><span class="p">,</span>
    <span class="s2">"emails"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="335f5a545b475d5a5d54735e50424656565d1d505c5e">[email protected]</a>"</span><span class="p">,</span>
            <span class="s2">"display_name"</span><span class="p">:</span> <span class="s2">"Lightning McQueen"</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">send_email_to_contact</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#    print(f"Sending email to {contact['emails']['address']} with subject={subject.title()} and {content=}")</span>
<span class="c1"># TypeError: list indices must be integers or slices, not str</span>


<span class="n">send_email_to_contact</span><span class="p">({},</span> <span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#    print(f"Sending email to {contact['emails']['address']} with subject={subject.title()} and {content=}")</span>
<span class="c1"># KeyError: 'emails'</span>


<span class="n">send_email_to_contact</span><span class="p">({</span><span class="s2">"emails"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="93fffaf4fbe7fdfafdf4d3fef0e2e6f6f6fdbdf0fcfe">[email protected]</a>"</span><span class="p">}},</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#     print(f"Sending email to {contact['emails']['address']} with subject={subject.title()} and {content=}")</span>
<span class="c1"># AttributeError: 'NoneType' object has no attribute 'title'</span>
</code></pre></div>

<p>Python 3.11:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">send_email_to_contact</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Sending email to </span><span class="si">{</span><span class="n">contact</span><span class="p">[</span><span class="s1">'emails'</span><span class="p">][</span><span class="s1">'address'</span><span class="p">]</span><span class="si">}</span><span class="s2"> with subject=</span><span class="si">{</span><span class="n">subject</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">content</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>


<span class="n">contact</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"Lightning"</span><span class="p">,</span>
    <span class="s2">"last_name"</span><span class="p">:</span> <span class="s2">"McQueen"</span><span class="p">,</span>
    <span class="s2">"emails"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e5898c828d918b8c8b82a58886949080808bcb868a88">[email protected]</a>"</span><span class="p">,</span>
            <span class="s2">"display_name"</span><span class="p">:</span> <span class="s2">"Lightning McQueen"</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">send_email_to_contact</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#     print(f"Sending email to {contact['emails']['address']} with {subject=} and {content=}")</span>
<span class="c1">#                               ~~~~~~~~~~~~~~~~~^^^^^^^^^^^</span>
<span class="c1"># TypeError: list indices must be integers or slices, not str</span>


<span class="n">send_email_to_contact</span><span class="p">({},</span> <span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#     print(f"Sending email to {contact['emails']['address']} with subject={subject.title()} and {content=}")</span>
<span class="c1">#                               ~~~~~~~^^^^^^^^^^</span>
<span class="c1"># KeyError: 'emails'</span>


<span class="n">send_email_to_contact</span><span class="p">({</span><span class="s2">"emails"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="55393c323d213b3c3b32153836242030303b7b363a38">[email protected]</a>"</span><span class="p">}},</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"Hello there! Long time no see."</span><span class="p">)</span>
<span class="c1">#     print(f"Sending email to {contact['emails']['address']} with subject={subject.title()} and {content=}")</span>
<span class="c1">#                                                                           ^^^^^^^^^^^^^</span>
<span class="c1"># AttributeError: 'NoneType' object has no attribute 'title'</span>
</code></pre></div>

<p>正如您所看到的，通过新的回溯可以更容易地找到错误所在。异常行中的确切问题点被很好地标记出来。在旧版本中，您只能看到异常本身和引发异常的行。</p>
<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3/whatsnew/3.11.html#whatsnew311-pep657">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0657/"> PEP-657 </a></li>
</ol>
<h2 id="exception-notes">异常注释</h2>
<p><code>add_note</code>被添加到<code>BaseExceptions</code>。这允许您在创建异常后向其添加额外的上下文。例如:</p>
<div class="codehilite"><pre><span/><code><span class="k">try</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="n">exc</span><span class="o">.</span><span class="n">add_note</span><span class="p">(</span><span class="s2">"When this happened my dog was barking and my kids were sleeping."</span><span class="p">)</span>
    <span class="k">raise</span>

<span class="c1">#     raise ValueError()</span>
<span class="c1"># ValueError</span>
<span class="c1"># When this happened my dog was barking and my kids were sleeping.</span>
</code></pre></div>

<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3/whatsnew/3.11.html#whatsnew311-pep678">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0678/"> PEP-678 </a></li>
</ol>
<h2 id="toml-library">TOML库</h2>
<p>Python现在有了一个用于解析<a href="https://toml.io/"> TOML </a>文件的库，名为<a href="https://docs.python.org/3.11/library/tomllib.html"> tomllib </a>。它的用法和内置的<code>json</code>库非常相似。</p>
<p>例如，假设您有下面的<em> pyproject.toml </em>文件:</p>
<div class="codehilite"><pre><span/><code><span class="k">[tool.poetry]</span><span class="w"/>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"example"</span><span class="w"/>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0.1.0"</span><span class="w"/>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span><span class="w"/>
<span class="n">authors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"/>

<span class="k">[tool.poetry.dependencies]</span><span class="w"/>
<span class="n">python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"^3.11"</span><span class="w"/>


<span class="k">[tool.poetry.dev-dependencies]</span><span class="w"/>

<span class="k">[build-system]</span><span class="w"/>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">"poetry-core&gt;=1.0.0"</span><span class="p">]</span><span class="w"/>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"poetry.core.masonry.api"</span><span class="w"/>
</code></pre></div>

<p>您可以像这样加载文件:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">tomllib</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"pyproject.toml"</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">tomllib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="sd">"""</span>
<span class="sd">{'build-system': {'build-backend': 'poetry.core.masonry.api',</span>
<span class="sd">                  'requires': ['poetry-core&gt;=1.0.0']},</span>
<span class="sd"> 'tool': {'poetry': {'authors': [],</span>
<span class="sd">                     'dependencies': {'python': '^3.11'},</span>
<span class="sd">                     'description': '',</span>
<span class="sd">                     'dev-dependencies': {},</span>
<span class="sd">                     'name': 'example',</span>
<span class="sd">                     'version': '0.1.0'}}}</span>
<span class="sd">"""</span>
</code></pre></div>

<p>更多信息:</p>
<ol>
<li><a href="https://docs.python.org/3/library/tomllib.html#module-tomllib">正式文件</a></li>
<li><a href="https://peps.python.org/pep-0680/"> PEP-680 </a></li>
</ol>
<h2 id="conclusion">结论</h2>
<p>如您所见，Python 3.11带来了许多令人兴奋的改进和特性。另一方面，一些遗留模块被弃用，另一些则被完全删除。因为这篇文章只涵盖了最有趣的新特性和变化，所以请务必查看所有变化的官方发布说明。</p>
<p>快乐的蟒蛇！</p>
  </div>

  </div>    
</body>
</html>