<html>
<head>
<title>Debugging a Containerized Django App in PyCharm </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在PyCharm中调试容器化的Django应用程序</h1>
<blockquote>原文：<a href="https://testdriven.io/blog/django-debugging-pycharm/#0001-01-01">https://testdriven.io/blog/django-debugging-pycharm/#0001-01-01</a></blockquote><div><div class="blog-content long-content" data-local-nav-source="">
    <p>在Docker中开发你的Django应用会非常方便。你不必安装额外的服务，如Postgres、Nginx和Redis等。在你自己的机器上。这也使得新开发人员更容易快速上手并运行。</p>
<p>然而，草并不总是更绿。在Docker中运行Django会产生一些问题，让原本简单的事情变得困难。例如，如何在代码中设置断点并进行调试？</p>
<p>在这个快速教程中，我们将了解PyCharm如何通过其远程解释器和Docker集成来帮助调试容器化的Django应用程序。</p>
<blockquote>
<p>本帖使用的是<a href="https://www.jetbrains.com/pycharm/"> PyCharm专业版</a> v2021.2.2，关于PyCharm专业版和社区(免费)版的区别，请看一下<a href="https://www.jetbrains.com/pycharm/features/editions_comparison_matrix.html">专业版与社区版对比指南</a>。</p>
</blockquote>



<h2 id="objectives">目标</h2>
<p>在本教程结束时，您应该能够在PyCharm中执行以下操作:</p>
<ol>
<li>配置Docker设置</li>
<li>设置远程解释器</li>
<li>创建一个运行/调试配置来调试Docker中运行的Django应用程序</li>
</ol>
<h2 id="docker-settings-in-pycharm">PyCharm中的坞站设置</h2>
<p>我们需要做的第一步是告诉PyCharm如何连接Docker。为此，打开PyCharm设置(<code>PyCharm &gt; Preferences</code>用于Mac用户，或者<code>File &gt; Settings</code>用于Windows和Linux用户)，然后展开“构建、执行、部署”设置。单击“Docker ”,然后单击“+”按钮创建新的Docker配置。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/pycharm_preferences.png" loading="lazy" class="lazyload" alt="PyCharm preferences" src="../Images/ec5605298f2ae6fa3bff393faaedec1f.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/pycharm_preferences.png"/></p>
<p>对于Mac，选择<code>Docker for Mac</code>选项。然后应用更改。</p>
<h2 id="configure-a-remote-interpreter">配置远程解释器</h2>
<p>现在我们已经设置了Docker配置，是时候将Docker Compose配置为远程解释器了。假设你已经打开了一个项目，再次打开设置，展开“项目:<code>&lt;your-project-name&gt;</code>”设置，点击“Python解释器”。单击齿轮图标，然后选择“添加”。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/pycharm_preferences_2.png" loading="lazy" class="lazyload" alt="PyCharm preferences interpreter" src="../Images/3bd35b95627c369b7e89e6586418c5c3.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/pycharm_preferences_2.png"/></p>
<p>在下一个对话框中，在左窗格中选择“Docker Compose ”,并在“Server”字段中选择您在前面步骤中创建的Docker配置。“配置文件”字段应该指向Docker合成文件，而“服务”字段应该指向Docker合成文件中的web应用程序服务。</p>
<p>例如，如果您的Docker Compose文件如下所示，那么您会希望指向<code>web</code>服务:</p>
<div class="codehilite"><pre><span/><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">'3.7'</span><span class="w"/>

<span class="nt">services</span><span class="p">:</span><span class="w"/>
<span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./app</span><span class="w"/>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python manage.py runserver 0.0.0.0:8000</span><span class="w"/>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./app/:/usr/src/app/</span><span class="w"/>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8008:8000</span><span class="w"/>
<span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./.env.dev</span><span class="w"/>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db</span><span class="w"/>
<span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:12.0-alpine</span><span class="w"/>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres_data:/var/lib/postgresql/data/</span><span class="w"/>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_USER=hello_django</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_PASSWORD=hello_django</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_DB=hello_django_dev</span><span class="w"/>

<span class="nt">volumes</span><span class="p">:</span><span class="w"/>
<span class="w">  </span><span class="nt">postgres_data</span><span class="p">:</span><span class="w"/>
</code></pre></div>

<p>调试器专门附加到web服务。当我们稍后在PyCharm中运行配置时，Docker Compose文件中的所有其他服务都将启动</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/add_python_interpreter.png" loading="lazy" class="lazyload" alt="Add interpreter" src="../Images/d9b0a5a7e924860116ac5e933690f42c.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/add_python_interpreter.png"/></p>
<p>单击“确定”应用更改。</p>
<p>回到“Python解释器”设置对话框，你现在应该看到项目有正确的远程解释器。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/remote_interpreter.png" loading="lazy" class="lazyload" alt="Remote interpreter" src="../Images/f99dd236ed9f1762d5f3f4967c79dba1.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/remote_interpreter.png"/></p>
<p>关闭设置。</p>
<h2 id="create-a-rundebug-configuration">创建运行/调试配置</h2>
<p>既然我们已经将PyCharm配置为能够连接到Docker，并基于Docker Compose文件创建了一个远程解释器配置，那么我们就可以创建一个运行/调试配置了。</p>
<p>点击“添加配置...”PyCharm窗口顶部的按钮。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/add_configuration.png" loading="lazy" class="lazyload" alt="Add run configuration" src="../Images/0fa9230b5930cf6bcc9449789418d233.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/add_configuration.png"/></p>
<p>接下来点击“+”按钮并选择“Django服务器”。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/add_configuration_2.png" loading="lazy" class="lazyload" alt="Add run configuration step 2" src="../Images/53d493490e2e73ba82c005a4e1f46849.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/add_configuration_2.png"/></p>
<p>为配置命名。在这个配置对话框中，重要的是将“主机”字段设置为<code>0.0.0.0</code>。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/add_configuration_3.png" loading="lazy" class="lazyload" alt="Add run configuration step 3" src="../Images/9df2e1e33d23fbf470fddfea85c69d2d.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/add_configuration_3.png"/></p>
<p>单击“确定”保存配置。我们现在可以在PyCharm窗口的顶部看到运行/调试配置，以及运行、调试等按钮。)已启用。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/run_configuration.png" loading="lazy" class="lazyload" alt="The finished run configuration" src="../Images/9f0cfc12458af793133163a5622627f1.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/run_configuration.png"/></p>
<p>如果现在在Django应用程序中设置断点，并按下运行/调试配置旁边的调试按钮，就可以调试Docker容器中运行的Django应用程序了。</p>
<p><img data-src="/static/images/blog/django/django-debugging-pycharm/debugging.png" loading="lazy" class="lazyload" alt="Debugging in the Docker container" src="../Images/c4319c5a0bd043c96d564296d3cdd33c.png" data-original-src="https://testdriven.io/static/images/blog/django/django-debugging-pycharm/debugging.png"/></p>
<h2 id="conclusion">结论</h2>
<p>在本教程中，我们向您展示了如何配置PyCharm来调试运行在Docker中的Django应用程序。有了它，您现在不仅可以调试您的视图和模型等等，还可以设置断点和调试您的模板代码。</p>
<blockquote>
<p>提示:想进一步增强您的调试能力吗？PyCharm还允许您设置<a href="https://www.jetbrains.com/pycharm/guide/tips/conditional-breakpoints/">条件断点</a>！</p>
</blockquote>
  </div>

  </div>    
</body>
</html>